name: Check Prohibited Imports

on:
  workflow_call:

jobs:
  check-imports:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - name: Check for prohibited imports
      run: |
        echo "Checking for prohibited Material and Cupertino imports in lib directory..."

        # Check for material.dart imports
        MATERIAL_IMPORTS=$(grep -r "import.*material\.dart" lib/ || true)

        # Check for cupertino.dart imports
        CUPERTINO_IMPORTS=$(grep -r "import.*cupertino\.dart" lib/ || true)

        # Report all findings first
        FOUND_VIOLATIONS=false

        if [ ! -z "$MATERIAL_IMPORTS" ]; then
          echo "❌ Found prohibited material.dart imports:"
          echo "$MATERIAL_IMPORTS"
          FOUND_VIOLATIONS=true
        fi

        if [ ! -z "$CUPERTINO_IMPORTS" ]; then
          echo "❌ Found prohibited cupertino.dart imports:"
          echo "$CUPERTINO_IMPORTS"
          FOUND_VIOLATIONS=true
        fi

        # Exit with error if any violations were found
        if [ "$FOUND_VIOLATIONS" = true ]; then
          exit 1
        fi

        echo "✅ No prohibited imports found!"
